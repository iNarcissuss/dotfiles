#!/bin/sh

case $1 in
    "work")
        rm -f "/tmp/$USER-nowork"
        cat > "/tmp/$USER-work" <<-EOF
[user]
    name = Rich Healey
    email = richard.healey@99designs.com
EOF
        ;;
    "nowork")
        rm -f "/tmp/$USER-work"
        touch "/tmp/$USER-nowork"
        ;;
    "vmup")
        VBoxManage list vms | while read name id; do
            if [ -n $2 ]; then
                echo $name | grep $2 > /dev/null &&
                    VBoxManage startvm ${id} --type headless
            else
                VBoxManage startvm ${id} --type headless
            fi
        done
        ;;
    "vmdown")
        VBoxManage list vms | while read name id; do
            if [ -n $2 ]; then
                echo $name | grep $2 > /dev/null &&
                    VBoxManage controlvm ${id} poweroff
            else
                VBoxManage controlvm ${id} poweroff
            fi
        done
        ;;
    *)
        echo "usage: $0 (no[work]|vmup)"
        exit 1;;
esac
